<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" as="font" href="https://gh-docs.msupply.foundation/fonts/vendor/jost/jost-v4-latin-regular.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://gh-docs.msupply.foundation/fonts/vendor/jost/jost-v4-latin-700.woff2"  type="font/woff2" crossorigin>


<link rel="stylesheet" href="https://gh-docs.msupply.foundation/main.css">
<link rel="stylesheet" href="https://gh-docs.msupply.foundation/msupply.css">




  
  
    
  

  
  
    
    
  
  
  
    
  
  
  
  
    
  
  
  


  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">


	


	

<title>Scheduled Email Reports - mSupply</title>
<meta name="description" content="mSupply Dashboard Panels.">
<link rel="canonical" href="https://gh-docs.msupply.foundation/dashboard/scheduled-excel/">










<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    
      
      
        
        
        
        
        
        
        
        
          {
            "@type": "ListItem",
            "position":  1 ,
            "name": "Home",
            "item": "https://gh-docs.msupply.foundation/"
          },
          
          
          {
            "@type": "ListItem",
            "position":  2 ,
            "name": "Dashboard",
            "item": "https://gh-docs.msupply.foundation/dashboard/"
          },
        
      
        
        
        
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  3 ,
            "name": "Scheduled Excel",
            "item": "https://gh-docs.msupply.foundation/dashboard/scheduled-excel/"
          },
        
      
    
  }
</script>






  <meta name="theme-color" content="#fff">
  <link rel="apple-touch-icon" sizes="180x180" href="https://gh-docs.msupply.foundation/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://gh-docs.msupply.foundation/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://gh-docs.msupply.foundation/favicon-16x16.png">
  
    <link rel="manifest" href="https://gh-docs.msupply.foundation/site.webmanifest" crossorigin>
  


  

</head>
 
   

<body class="docs single">
   
   
   
  

    

<div class="header-bar fixed-top"></div>
<header class="navbar fixed-top navbar-expand-md navbar-light">
	<div class="container">
		<input class="menu-btn order-0" type="checkbox" id="menu-btn">
		<label class="menu-icon d-md-none" for="menu-btn"><span class="navicon"></span></label>
		<a class="navbar-brand order-1 order-md-0 me-auto" href="https://gh-docs.msupply.foundation/">mSupply</a>
		<button id="mode" class="btn btn-link order-2 order-md-4" type="button" aria-label="Toggle mode">
			<span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span>
			<span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></span>
		</button>
		<ul class="navbar-nav fork-me order-3 order-md-5">
			
				
					<li class="nav-item">
						<a class="nav-link" href="https://twitter.com/mSupply"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg><span class="ms-2 visually-hidden">Twitter</span></a>
					</li>
				
			
		</ul>
		<div class="collapse navbar-collapse order-4 order-md-1">
			<ul class="navbar-nav main-nav me-auto order-5 order-md-2">
				
					
				
				
				
					
						<li class="nav-item">
							<a class="nav-link" href="https://gh-docs.msupply.foundation/docs/introduction/introduction/">Open mSupply (Desktop+Mobile)</a>
						</li>
					
						<li class="nav-item">
							<a class="nav-link" href="https://gh-docs.msupply.foundation/coldchain/introduction/">Coldchain</a>
						</li>
					
						<li class="nav-item dashboard active">
							<a class="nav-link" href="https://gh-docs.msupply.foundation/dashboard/introduction/">Dashboard</a>
						</li>
					
						<li class="nav-item">
							<a class="nav-link" href="https://gh-docs.msupply.foundation/mobile/introduction/introduction/">Mobile (Legacy)</a>
						</li>
					
						<li class="nav-item">
							<a class="nav-link" href="https://gh-docs.msupply.foundation/health-supply-hub/introduction/">Health Supply Hub</a>
						</li>
					
				
			</ul>
			<div class="break order-6 d-md-none"></div>
			
				<form class="navbar-form flex-grow-1 order-7 order-md-3">
					<input id="userinput" class="form-control is-search" type="search" placeholder="Search docs..."
						aria-label="Search docs..." autocomplete="off">
					<div id="suggestions" class="shadow bg-white rounded"></div>
				</form>
			
		</div>
	</div>
</header>
 


  
<div class="wrap container" role="document">
  <div class="content">
    <div class="row flex-xl-nowrap">
      
<div class="col-lg-5 col-xl-4 docs-sidebar">
	<nav class="docs-links" aria-label="Main navigation">
		
			
		
			
			
					<h3>mSupply Dashboard</h3>
					<ul class="list-unstyled">
					                           
							<li><a class="docs-link" href="https://gh-docs.msupply.foundation/dashboard/introduction/">mSupply Dashboard</a></li>
					                           
							<li><a class="docs-link" href="https://gh-docs.msupply.foundation/dashboard/panels/">Dashboard Panels</a></li>
					                           
							<li><a class="docs-link active" href="https://gh-docs.msupply.foundation/dashboard/scheduled-excel/">Scheduled Email Reports</a></li>
					
					</ul>
			
			
					
					
					
					
			
	</nav>
</div>
  
<nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation">
  <div class="page-links">
    <h3>On this page</h3>
    <nav id="TableOfContents">
      <ul>
        
      </ul>
    </nav>
  </div>
</nav>
 
      <main class="docs-content col-lg-11 col-xl-9">
        
        <div class="flagster" style="float: right; padding: 5px">
          <a href="https:&#x2F;&#x2F;gh-docs.msupply.foundation&#x2F;dashboard&#x2F;scheduled-excel&#x2F;" title="Change language to en"
            >üá¨üáß</a
          >
        </div>
        

        <h1>Scheduled Email Reports</h1>
        
        <p class="lead">Regular Excel Reports via Email</p>
         <p>Excel report e-mail scheduler</p>
<p>Generate Excel reports from mSupply dashboard. Send the reports to custom created user-groups on pre-defined schedule. Supported Grafana version is later v8.0.0</p>
<p>This is a custom plugin which will need to be installed on your server. Contact mSupply support if this plugin is not available to you.</p>
<p>NOTE: you need to have Grafana administrative rights to set up and use this plugin. The plugin icon does not show in the sidebar for non-administrative accounts.
Initial Plugin Setup</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Click on Settings on the sidebar menu (on the left-hand side of the mSupply Dashboard).
</span><span>Select the Plugins tab.
</span><span>Search for ‚ÄúmSupply‚Äù.
</span><span>Click on Excel report e-mail scheduler.
</span></code></pre>
<p>The App Configuration window will open and you will need to complete this form before you start to use the reporting functionality.</p>
<p>Click Enable for the plugin.</p>
<p>Once enabled, the mSupply icon will be displayed on the sidebar menu above the settings button.</p>
<p>Please enter your administrator Grafana Details:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Username and password
</span><span>URL for your mSupply Web Dashboard
</span></code></pre>
<p>Please enter the Email Details for the account from which emails will be sent:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Email address and password
</span><span>Email host and port (from your email provider: this will be the same details that you would enter when creating a new email account)
</span></code></pre>
<p>Your email provider's security settings may require additional steps to allow email setup.</p>
<p>For Datasource, please select the source location for your mSupply data. In most cases this will be PostgreSQL. If you are not sure, please check with your mSupply consultant.</p>
<p>Once completed, please select Save settings.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>If the form is incomplete or the information provided is incorrect, you will receive an error message on submission. Please follow the instructions given in the error message.
</span><span>On successful submission, you will receive the following message:
</span></code></pre>
<p>Selecting Disable will deactivate the mSupply plugin and you will need to repeat the above in order to enable it again.</p>
<p>You are now ready to get started creating Reporting Groups!
Setting Up a Report Group</p>
<p>To access report groups, select the mSupply icon from the sidebar menu and select Report Groups from the drop-down menu.</p>
<p>In the following window select Add report group. This will create a New report group as seen below ‚Äì click on this row to edit the report group details.</p>
<p>Edit report group details page:</p>
<p>In the Edit details section there are free-text boxes for:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Name
</span><span>Group description
</span></code></pre>
<p>Selected Users</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>List of selected users shown here
</span></code></pre>
<p>Select the users that you want to be in your report group.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>A list is provided of all mSupply users
</span><span>You can show only mSupply users with an email address when Hide users without email toggle is on.
</span></code></pre>
<p>New users (or changes to a user‚Äôs details) will not be updated from mSupply into the Dashboard immediately. It is depending on the timing of the dashboard export scheduler in mSupply. If you require an immediate update for Reports, please complete a manual export of user table from mSupply to the Dashboard.</p>
<p>Click on Create Report Group or Update Report Group (When you edit) to save.</p>
<p>When you hover your mouse over the group, Edit and DELETE buttons appear.</p>
<p>Delete will remove the report group. You will receive a prompt to confirm deletion.</p>
<p>Setting Up a Report Schedule</p>
<p>To access Report schedules, select the mSupply icon from the sidebar menu and select Schedules from the drop-down menu.</p>
<p>In the following window select Create new schedule. This will create a New report schedule as below ‚Äì click on this row to edit the schedule details.</p>
<p>Edit report schedule details page:</p>
<p>In the Edit details section:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Name: free-text box that will also be the email subject.
</span><span>Description: free-text box
</span><span>Report group: select the name of the group that should receive the report
</span><span>Report interval: select the required reporting period from the drop-down box
</span></code></pre>
<p>The emails will be sent according to the selected interval from the time the report schedule is created. For example, if a daily schedule is set up at 9am on 1 January 2021, the email will be sent every day at 9am from 2 January 2021.</p>
<p>Then select from the Available Panels to be displayed in the report:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Any number of panels can be selected. Each panel will be on a separate worksheet in an attached Excel workbook - refer Report template.
</span><span>Only ‚Äútable‚Äù panels are supported.
</span></code></pre>
<p>For each panel selected, you will also need to specify the Variables to be displayed in the emailed report. This is done via the drop-down boxes that will be displayed once a panel is selected as shown in the below example for Expiry Items.</p>
<p>Using the drop-down boxes, you can choose the variables (in this case Store and Item) that you want displayed in the emailed report. Only the variables displayed within the Report Schedule screen are available for each panel.</p>
<p>The Grafana format of variables must be in the form: ${variable} or ${variable:sqlstring}. Other formats are not supported for dashboard reports. 1)</p>
<p>Grafana macros are not supported with the following exception:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>The $ timeFrom and $ timeTo and $ timeFilter macros are supported using a Lookback variable. The $ timeTo date is set to date of report creation. The $ timeFrom will then be calculated as ($ timeTo ‚Äì Lookback).
</span><span>For example, if you set a lookback period of 7 days and create a daily report starting on 1 January 2021. The first report‚Äôs $ timeFrom will be 24 December 2020 and the $ timeTo will be 1 January 2021. The second report‚Äôs $ timeFrom will be 25 December 2020 and the $ timeTo will be 2 January 2021. 2)
</span></code></pre>
<p>Press Create schedule button on the bottom of the page.</p>
<p>Once you saved the scheduler, you can press Send Test button (top right corner) from the edit schedules. Please note:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Send Test will not affect the timing of the schedule (the timing of the schedule is dependent on the time you save and close the report schedule)
</span><span>Send Test will send the email to all users in the report group!
</span></code></pre>
<p>DELETE will remove the report schedule. You will receive a prompt to confirm deletion.</p>
<p>Report Template</p>
<p>The panels selected in a report schedule will be sent via email in an Excel workbook:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Each panel will be on a separate worksheet.
</span><span>Each worksheet will display in the title:
</span><span>    Date of Creation
</span><span>    Name of the Panel
</span></code></pre>
  
<div class="docs-navigation d-flex justify-content-between">
  
  
  
  
  
  <a href="https:&#x2F;&#x2F;gh-docs.msupply.foundation&#x2F;dashboard&#x2F;panels&#x2F;">
    <div class="card my-1">
      <div class="card-body py-2">
        &larr; Dashboard Panels
      </div>
    </div>
  </a>
  

  
  
  
  
  
    
    
    
    
  
</div>

      </main>
    </div>
  </div>
</div>


  
    
<footer class="footer text-muted">
	<div class="container">
		<div class="row">
			<div class="col-lg-8 order-last order-lg-first">
				<ul class="list-inline">
					
						<li class="list-inline-item">Powered by <a href="https://www.getzola.org/">Zola</a>, and <a href="https://github.com/aaranxu/adidoks">AdiDoks</a></li>
					
				</ul>
			</div>
			<div class="col-lg-8 order-first order-lg-last text-lg-end">
				<ul class="list-inline">
					
				</ul>
			</div>
		</div>
	</div>
</footer>

  

  
<script type="text/javascript" src="https://gh-docs.msupply.foundation/js/main.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>mermaid.initialize({startOnLoad:true});</script>

  <script type="text/javascript" src="https://gh-docs.msupply.foundation/plugins/elasticlunr.min.js" defer></script>
  <script type="text/javascript" src="https://gh-docs.msupply.foundation/plugins/lunr.stemmer.support.js" defer></script>
  <script type="text/javascript" src="https://gh-docs.msupply.foundation/plugins/lunr.fr.js" defer></script>
  <script type="text/javascript" src="https://gh-docs.msupply.foundation/search_index.en.js" defer></script>
  <script type="text/javascript" src="https://gh-docs.msupply.foundation/js/search.js" defer></script>

  
</body>
</html>
